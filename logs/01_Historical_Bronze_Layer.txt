Requirement already satisfied: newsapi-python in /local_disk0/.ephemeral_nfs/envs/pythonEnv-844d428b-9627-4358-8c1b-2e68d26e581b/lib/python3.12/site-packages (0.2.7)
Requirement already satisfied: requests<3.0.0 in /databricks/python3/lib/python3.12/site-packages (from newsapi-python) (2.32.2)
Requirement already satisfied: charset-normalizer<4,>=2 in /databricks/python3/lib/python3.12/site-packages (from requests<3.0.0->newsapi-python) (2.0.4)
Requirement already satisfied: idna<4,>=2.5 in /databricks/python3/lib/python3.12/site-packages (from requests<3.0.0->newsapi-python) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /databricks/python3/lib/python3.12/site-packages (from requests<3.0.0->newsapi-python) (1.26.16)
Requirement already satisfied: certifi>=2017.4.17 in /databricks/python3/lib/python3.12/site-packages (from requests<3.0.0->newsapi-python) (2024.6.2)
Note: you may need to restart the kernel using %restart_python or dbutils.library.restartPython() to use updated packages.
ğŸ”§ Bronze Layer Processor - Working Version with Table Creation
======================================================================
â° Started: 2025-07-21 22:22:03
âœ… Configuration loaded successfully
ğŸ“‹ Stock table: databricks_stock_sentiment_canada.bronze.historical_stock_data
ğŸ“‹ News table: databricks_stock_sentiment_canada.bronze.historical_news_data
ğŸ“ˆ Stock symbols: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'META', 'TSLA']
ğŸ“° News keywords: ['stock market', 'earnings', 'financial']
ğŸ“‹ Batch ID: bronze_20250721_222204
âœ… Exact schema definitions loaded

ğŸš€ Starting Working Bronze Pipeline
ğŸ“‹ Batch ID: bronze_20250721_222204
â° Started: 2025-07-21 22:22:04

ğŸ—ï¸ Phase 0: Table Setup

ğŸ—ï¸ Checking and creating tables if needed...
âœ… Schema databricks_stock_sentiment_canada.bronze ready
ğŸ—ï¸ Creating managed stock table databricks_stock_sentiment_canada.bronze.historical_stock_data...
âœ… Stock table created successfully
ğŸ—ï¸ Creating managed news table databricks_stock_sentiment_canada.bronze.historical_news_data...
âœ… News table created successfully
âœ… All tables are ready

ğŸ“ˆ Phase 1: Stock Data Collection

ğŸ“ˆ Fetching stock data...
ğŸ“ˆ Fetching AAPL...
âœ… AAPL: $211.18 (Volume: 48,974,591.0)
ğŸ“ˆ Fetching GOOGL...
âœ… GOOGL: $185.06 (Volume: 34,014,509.0)
ğŸ“ˆ Fetching MSFT...
âœ… MSFT: $510.05 (Volume: 21,209,666.0)
ğŸ“ˆ Fetching AMZN...
âœ… AMZN: $226.13 (Volume: 37,833,807.0)
ğŸ“ˆ Fetching META...
âœ… META: $704.28 (Volume: 12,779,752.0)
ğŸ“ˆ Fetching TSLA...
âœ… TSLA: $329.65 (Volume: 94,254,993.0)
âœ… Fetched 6 stock records

ğŸ“° Phase 2: News Data Collection

ğŸ“° Fetching news data...
ğŸ“° Fetching news for 'stock market'...
âœ… Added: Stock market today: Live updates...
âœ… Added: Is It Time To Consider Buying Retail Food Group Li...
âœ… Added: Antiquated Social Security investment rules could ...
âœ… Added: US Stock market prediction: Will Wall Street perfo...
âœ… Added: Live: Market awaits European rates decision, Nasda...
âœ… Added: PM Modi to visit Britain, Maldives...
âœ… Added: The stock market is being led by a new group of wi...
âœ… Added: Your Photography Skills Are Already Obsolete (You ...
âœ… Added: Analyst Says Amazon.com (AMZN) Cloud Business Need...
âœ… Added: The stock market is being led by a new group of wi...
ğŸ“° Fetching news for 'earnings'...
âœ… Added: LGI (ASX:LGI) Shareholders Will Want The ROCE Traj...
âœ… Added: Tariffs threaten high-value stocks, analysts warn...
âœ… Added: Box Office Report: Suddenly Last Summer...
âœ… Added: Stock market today: Live updates...
âœ… Added: Is It Time To Consider Buying Retail Food Group Li...
âœ… Added: The Westpac share price is a buy â€“ UBS...
âœ… Added: US Stock market prediction: Will Wall Street perfo...
âœ… Added: Five Key Charts to Watch in Global Commodity Marke...
âœ… Added: Tesla, Verizon, Coca-Cola, Alphabet, and More Stoc...
âœ… Added: GENIUS Act Passed: Dogecoin Surges to $0.27 â€” Pala...
ğŸ“° Fetching news for 'financial'...
âœ… Added: LGI (ASX:LGI) Shareholders Will Want The ROCE Traj...
âœ… Added: India to boost arms exports...
âœ… Added: Stock market today: Live updates...
âœ… Added: Is It Time To Consider Buying Retail Food Group Li...
âœ… Added: Bitcoin is becoming infrastructureâ€”not just an ass...
âœ… Added: The Paradox of Autism Causation Studies...
âœ… Added: One Manâ€™s Fight To Make Fashion Fair Transparent A...
âœ… Added: The Westpac share price is a buy â€“ UBS...
âœ… Added: Sad Double Heartbreak for 'Love Actually' Star Mar...
âœ… Added: Mamadou Sarr set to rejoin RC Strasbourg on loan f...
âœ… Fetched 30 news records

ğŸ’¾ Phase 3: Data Persistence

ğŸ’¾ Saving 6 stock records...
âœ… Stock DataFrame created with exact schema
âœ… Stock data saved to Unity Catalog

ğŸ’¾ Saving 30 news records...
âœ… News DataFrame created with exact schema
âœ… News data saved to Unity Catalog

============================================================
ğŸ¯ BRONZE PIPELINE SUMMARY
============================================================
ğŸ“‹ Batch ID: bronze_20250721_222204
â° Duration: 0.43 minutes
ğŸ“ˆ Stock records saved: 6
ğŸ“° News records saved: 30
ğŸ“Š Total records: 36
âœ… Status: SUCCESS
ğŸ¯ Tables created and data saved!
============================================================

ğŸ‰ Working Bronze Layer Processing Completed!

ğŸ” Final Verification:
ğŸ“ˆ Stock: 6 new records (total: 6)
+------+-----------+----------+
|symbol|close_price|volume    |
+------+-----------+----------+
|AAPL  |211.18     |48974591.0|
|GOOGL |185.06     |34014509.0|
|MSFT  |510.05     |21209666.0|
+------+-----------+----------+
only showing top 3 rows
ğŸ“° News: 30 new records (total: 30)
+------------------------------------------------------------------------------------------+-------------------+-------------------------+
|title                                                                                     |source             |financial_relevance_score|
+------------------------------------------------------------------------------------------+-------------------+-------------------------+
|Stock market today: Live updates                                                          |CNBC               |0.0                      |
|Is It Time To Consider Buying Retail Food Group Limited (ASX:RFG)?                        |Yahoo Entertainment|0.0                      |
|Antiquated Social Security investment rules could make government miss billions in returns|Wnd.com            |0.0                      |
+------------------------------------------------------------------------------------------+-------------------+-------------------------+
only showing top 3 rows

ğŸ”§ BRONZE LAYER SUCCESS!
âœ… Tables created successfully
âœ… Data successfully saved
âœ… Ready for Silver layer processing
ğŸ“‹ Stock Table: databricks_stock_sentiment_canada.bronze.historical_stock_data
ğŸ“‹ News Table: databricks_stock_sentiment_canada.bronze.historical_news_data

â° Completed: 2025-07-21 22:22:32
ğŸ”§ Working Bronze Layer Processor - Schema Compatible with Auto Table Creation!