Requirement already satisfied: newsapi-python in /local_disk0/.ephemeral_nfs/envs/pythonEnv-844d428b-9627-4358-8c1b-2e68d26e581b/lib/python3.12/site-packages (0.2.7)
Requirement already satisfied: requests<3.0.0 in /databricks/python3/lib/python3.12/site-packages (from newsapi-python) (2.32.2)
Requirement already satisfied: charset-normalizer<4,>=2 in /databricks/python3/lib/python3.12/site-packages (from requests<3.0.0->newsapi-python) (2.0.4)
Requirement already satisfied: idna<4,>=2.5 in /databricks/python3/lib/python3.12/site-packages (from requests<3.0.0->newsapi-python) (3.7)
Requirement already satisfied: urllib3<3,>=1.21.1 in /databricks/python3/lib/python3.12/site-packages (from requests<3.0.0->newsapi-python) (1.26.16)
Requirement already satisfied: certifi>=2017.4.17 in /databricks/python3/lib/python3.12/site-packages (from requests<3.0.0->newsapi-python) (2024.6.2)
Note: you may need to restart the kernel using %restart_python or dbutils.library.restartPython() to use updated packages.
🔧 Bronze Layer Processor - Working Version with Table Creation
======================================================================
⏰ Started: 2025-07-21 22:22:03
✅ Configuration loaded successfully
📋 Stock table: databricks_stock_sentiment_canada.bronze.historical_stock_data
📋 News table: databricks_stock_sentiment_canada.bronze.historical_news_data
📈 Stock symbols: ['AAPL', 'GOOGL', 'MSFT', 'AMZN', 'META', 'TSLA']
📰 News keywords: ['stock market', 'earnings', 'financial']
📋 Batch ID: bronze_20250721_222204
✅ Exact schema definitions loaded

🚀 Starting Working Bronze Pipeline
📋 Batch ID: bronze_20250721_222204
⏰ Started: 2025-07-21 22:22:04

🏗️ Phase 0: Table Setup

🏗️ Checking and creating tables if needed...
✅ Schema databricks_stock_sentiment_canada.bronze ready
🏗️ Creating managed stock table databricks_stock_sentiment_canada.bronze.historical_stock_data...
✅ Stock table created successfully
🏗️ Creating managed news table databricks_stock_sentiment_canada.bronze.historical_news_data...
✅ News table created successfully
✅ All tables are ready

📈 Phase 1: Stock Data Collection

📈 Fetching stock data...
📈 Fetching AAPL...
✅ AAPL: $211.18 (Volume: 48,974,591.0)
📈 Fetching GOOGL...
✅ GOOGL: $185.06 (Volume: 34,014,509.0)
📈 Fetching MSFT...
✅ MSFT: $510.05 (Volume: 21,209,666.0)
📈 Fetching AMZN...
✅ AMZN: $226.13 (Volume: 37,833,807.0)
📈 Fetching META...
✅ META: $704.28 (Volume: 12,779,752.0)
📈 Fetching TSLA...
✅ TSLA: $329.65 (Volume: 94,254,993.0)
✅ Fetched 6 stock records

📰 Phase 2: News Data Collection

📰 Fetching news data...
📰 Fetching news for 'stock market'...
✅ Added: Stock market today: Live updates...
✅ Added: Is It Time To Consider Buying Retail Food Group Li...
✅ Added: Antiquated Social Security investment rules could ...
✅ Added: US Stock market prediction: Will Wall Street perfo...
✅ Added: Live: Market awaits European rates decision, Nasda...
✅ Added: PM Modi to visit Britain, Maldives...
✅ Added: The stock market is being led by a new group of wi...
✅ Added: Your Photography Skills Are Already Obsolete (You ...
✅ Added: Analyst Says Amazon.com (AMZN) Cloud Business Need...
✅ Added: The stock market is being led by a new group of wi...
📰 Fetching news for 'earnings'...
✅ Added: LGI (ASX:LGI) Shareholders Will Want The ROCE Traj...
✅ Added: Tariffs threaten high-value stocks, analysts warn...
✅ Added: Box Office Report: Suddenly Last Summer...
✅ Added: Stock market today: Live updates...
✅ Added: Is It Time To Consider Buying Retail Food Group Li...
✅ Added: The Westpac share price is a buy – UBS...
✅ Added: US Stock market prediction: Will Wall Street perfo...
✅ Added: Five Key Charts to Watch in Global Commodity Marke...
✅ Added: Tesla, Verizon, Coca-Cola, Alphabet, and More Stoc...
✅ Added: GENIUS Act Passed: Dogecoin Surges to $0.27 — Pala...
📰 Fetching news for 'financial'...
✅ Added: LGI (ASX:LGI) Shareholders Will Want The ROCE Traj...
✅ Added: India to boost arms exports...
✅ Added: Stock market today: Live updates...
✅ Added: Is It Time To Consider Buying Retail Food Group Li...
✅ Added: Bitcoin is becoming infrastructure—not just an ass...
✅ Added: The Paradox of Autism Causation Studies...
✅ Added: One Man’s Fight To Make Fashion Fair Transparent A...
✅ Added: The Westpac share price is a buy – UBS...
✅ Added: Sad Double Heartbreak for 'Love Actually' Star Mar...
✅ Added: Mamadou Sarr set to rejoin RC Strasbourg on loan f...
✅ Fetched 30 news records

💾 Phase 3: Data Persistence

💾 Saving 6 stock records...
✅ Stock DataFrame created with exact schema
✅ Stock data saved to Unity Catalog

💾 Saving 30 news records...
✅ News DataFrame created with exact schema
✅ News data saved to Unity Catalog

============================================================
🎯 BRONZE PIPELINE SUMMARY
============================================================
📋 Batch ID: bronze_20250721_222204
⏰ Duration: 0.43 minutes
📈 Stock records saved: 6
📰 News records saved: 30
📊 Total records: 36
✅ Status: SUCCESS
🎯 Tables created and data saved!
============================================================

🎉 Working Bronze Layer Processing Completed!

🔍 Final Verification:
📈 Stock: 6 new records (total: 6)
+------+-----------+----------+
|symbol|close_price|volume    |
+------+-----------+----------+
|AAPL  |211.18     |48974591.0|
|GOOGL |185.06     |34014509.0|
|MSFT  |510.05     |21209666.0|
+------+-----------+----------+
only showing top 3 rows
📰 News: 30 new records (total: 30)
+------------------------------------------------------------------------------------------+-------------------+-------------------------+
|title                                                                                     |source             |financial_relevance_score|
+------------------------------------------------------------------------------------------+-------------------+-------------------------+
|Stock market today: Live updates                                                          |CNBC               |0.0                      |
|Is It Time To Consider Buying Retail Food Group Limited (ASX:RFG)?                        |Yahoo Entertainment|0.0                      |
|Antiquated Social Security investment rules could make government miss billions in returns|Wnd.com            |0.0                      |
+------------------------------------------------------------------------------------------+-------------------+-------------------------+
only showing top 3 rows

🔧 BRONZE LAYER SUCCESS!
✅ Tables created successfully
✅ Data successfully saved
✅ Ready for Silver layer processing
📋 Stock Table: databricks_stock_sentiment_canada.bronze.historical_stock_data
📋 News Table: databricks_stock_sentiment_canada.bronze.historical_news_data

⏰ Completed: 2025-07-21 22:22:32
🔧 Working Bronze Layer Processor - Schema Compatible with Auto Table Creation!