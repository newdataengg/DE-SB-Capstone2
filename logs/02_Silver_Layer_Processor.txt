ğŸ¥ˆ Silver Layer Processor - Complete Combined Version
============================================================
â° Started: 2025-07-21 22:23:12
ğŸ¯ Focus: Bronze â†’ Silver with explicit schemas and comprehensive analytics
ğŸ“‹ Current catalog: databricks_stock_sentiment_canada
âœ… Configuration loaded successfully
ğŸ“Š Bronze Stock Table: databricks_stock_sentiment_canada.bronze.historical_stock_data
ğŸ“° Bronze News Table: databricks_stock_sentiment_canada.bronze.historical_news_data
ğŸ“Š Enhanced processing configuration:
   batch_size: 1000
   finbert_confidence_threshold: 0.6
   data_quality_threshold: 0.7
   technical_indicators_window: 20
   sentiment_aggregation_window: 7
   correlation_analysis_enabled: True
   feature_engineering_enabled: True
   max_news_records_per_batch: 50
   enable_explicit_schema: True
âœ… Explicit schemas defined for type-safe DataFrame creation
ğŸ“Š Stock schema: 51 fields
ğŸ“° News schema: 43 fields
ğŸ¤– Loading enhanced FinBERT model...

âœ… FinBERT model ready for production
ğŸ¤– FinBERT Status: Production Ready
ğŸ—ï¸ Creating enhanced Silver layer tables...
âœ… Silver schema created in catalog: databricks_stock_sentiment_canada
âœ… Created enhanced stock table: databricks_stock_sentiment_canada.silver.enhanced_stock_data
âœ… Created enhanced news table: databricks_stock_sentiment_canada.silver.enhanced_news_data
âœ… Enhanced Silver layer tables created successfully
ğŸš€ Launching Silver Layer Processing
ğŸ¯ Key Features:
   â€¢ Explicit schemas for type safety
   â€¢ Production FinBERT sentiment analysis
   â€¢ Comprehensive technical indicators
   â€¢ Enhanced error handling and stability
ğŸ§¹ Cleaning up existing Silver tables for fresh schema...
âœ… Dropped existing table: databricks_stock_sentiment_canada.silver.enhanced_stock_data
âœ… Dropped existing table: databricks_stock_sentiment_canada.silver.enhanced_news_data
âœ… Silver tables cleanup completed

ğŸ¥ˆ Starting Combined Silver Layer Processing
ğŸ“‹ Batch ID: silver_combined_20250721_222342
â° Started: 2025-07-21 22:23:42
ğŸ¯ Features: Explicit schemas + FinBERT + Technical indicators

ğŸ“Š Phase 1: Enhanced Stock Processing
ğŸ“ˆ Processing 6 stock records
ğŸ“Š Calculating comprehensive technical indicators...
âœ… Comprehensive technical indicators calculated with all required fields
âœ… Created 6 enhanced stock records

ğŸ¤– Phase 2: Enhanced News Processing with FinBERT
ğŸ“° Found 30 news records
ğŸ”„ Processing 30 high-quality news records with FinBERT...
ğŸ”„ Processed 10/30 (33.3%)
ğŸ”„ Processed 20/30 (66.7%)
ğŸ”„ Processed 30/30 (100.0%)
ğŸ’¾ Creating DataFrame with explicit schema for 30 records...
âœ… Created 30 enhanced news records

âš¡ Phase 3: Table Optimization
âœ… Optimized databricks_stock_sentiment_canada.silver.enhanced_stock_data (6 records)
âœ… Optimized databricks_stock_sentiment_canada.silver.enhanced_news_data (30 records)

================================================================================
ğŸ¥ˆ SILVER LAYER PROCESSING SUMMARY
================================================================================
ğŸ“‹ Processing Details:
   Batch ID: silver_combined_20250721_222342
   Duration: 0.30 minutes
   Start: 22:23:42
   End: 22:24:00

ğŸ“Š Processing Results:
   ğŸ“ˆ Stock Records: 6 â†’ 6
   ğŸ“° News Records: 30 â†’ 30
   ğŸ¯ Total Enhanced: 36 records

ğŸ¤– FinBERT Processing:
   Model Status: Production
   Total Calls: 30
   Avg Time: 150.55ms

ğŸ¯ Enhanced Features Created:
   âœ… Technical indicators (RSI, MACD, Bollinger Bands)
   âœ… FinBERT sentiment analysis with confidence
   âœ… Type-safe DataFrame creation with explicit schemas
   âœ… Quality scoring and reliability metrics
   âœ… Optimized for correlation analysis

âœ… STATUS: SUCCESS - Ready for Gold layer correlation analysis!
================================================================================

ğŸ‰ Combined Silver Layer Processing Complete!

ğŸ“Š Final Silver Layer Status:
   ğŸ“ˆ Enhanced Stock Records: 6
   ğŸ“° Enhanced News Records: 30

ğŸ”— Correlation Analysis Ready:
   âœ… Stock technical indicators available
   âœ… News sentiment analysis complete
   âœ… Both datasets in Silver layer
   ğŸš€ Ready for Gold layer processing!

ğŸ“Š Stock Data Preview:
+------+----------+-----------+-------+----------------+
|symbol|      date|close_price|rsi_14d|technical_signal|
+------+----------+-----------+-------+----------------+
|  AAPL|2025-07-18|     211.18|   50.0|            hold|
|  AMZN|2025-07-18|     226.13|   50.0|            hold|
| GOOGL|2025-07-18|     185.06|   50.0|            hold|
+------+----------+-----------+-------+----------------+


ğŸ“° News Data Preview:
+------------------------------------------------------------------------------------------+-------------+-------------+------------------+
|title                                                                                     |finbert_label|finbert_score|finbert_confidence|
+------------------------------------------------------------------------------------------+-------------+-------------+------------------+
|Mamadou Sarr set to rejoin RC Strasbourg on loan from Chelsea â€” report                    |positive     |0.8917       |0.8917            |
|Sad Double Heartbreak for 'Love Actually' Star Martine McCutcheon After Split From Husband|neutral      |0.3008       |0.596             |
|The Westpac share price is a buy â€“ UBS                                                    |positive     |0.8142       |0.8142            |
+------------------------------------------------------------------------------------------+-------------+-------------+------------------+


ğŸ” Final Silver Layer Verification
============================================================

ğŸ“Š Stock Data Verification:
   ğŸ“ˆ Records: 6
   ğŸ“Š Technical Indicators Quality: 100.00%
   âœ… Stock data ready for correlation analysis

ğŸ“° News Data Verification:
   ğŸ“° Records: 30
   ğŸ¤– High Confidence Predictions: 83.33%
   ğŸ“Š Average FinBERT Confidence: 0.776
   ğŸ¯ Sentiment Variety: 3 labels
   âœ… News data ready for correlation analysis

ğŸ”— Correlation Analysis Readiness:
   âœ… Both datasets are ready for correlation analysis
   âœ… Technical indicators calculated and validated
   âœ… FinBERT sentiment analysis completed
   âœ… Data quality thresholds met

ğŸ“Š Overall Silver Layer Quality Score: 90.0%

ğŸŠ SILVER LAYER PROCESSOR COMPLETED
================================================================================
ğŸ¯ STATUS: READY FOR ADVANCED ANALYTICS

â° Processing completed: 2025-07-21 22:24:03
